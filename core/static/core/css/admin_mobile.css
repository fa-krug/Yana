/**
 * Mobile-specific fixes for Django Admin with DjangoQL
 * Fixes overflow and alignment issues on narrow screens
 */

/* Mobile viewport fixes (max-width: 767px is Django admin's mobile breakpoint) */
@media (max-width: 767px) {

    /* Search form container - use CSS grid for precise layout control */
    #changelist-search>div {
        display: grid !important;
        grid-template-columns: auto auto 1fr !important;
        grid-template-rows: 44px 44px auto !important;
        gap: 8px !important;
        align-items: stretch !important;
        width: 100% !important;
    }

    /* Row 1: Search icon - first column */
    #changelist-search>div>label[for="searchbar"] {
        grid-column: 1;
        grid-row: 1;
        display: flex;
        align-items: center;
    }

    /* DjangoQL toggle checkbox - inline with search bar */
    #changelist-search .djangoql-toggle {
        grid-column: 2 !important;
        grid-row: 1 !important;
        height: auto !important;
        width: auto !important;
        align-self: center !important;
    }

    /* Search input - takes remaining space on first row, match button height */
    #changelist-search textarea#searchbar,
    #changelist-search .djangoql-textarea-container {
        grid-column: 3 !important;
        grid-row: 1 !important;
        width: 100% !important;
        min-width: 0 !important;
        box-sizing: border-box !important;
        height: 44px !important;
        min-height: 44px !important;
        padding: 10px !important;
        font-size: 16px !important;
        resize: none !important;
        margin: 0 !important;
    }

    /* Row 2: Search button - full width, same height as input */
    #changelist-search input[type="submit"] {
        grid-column: 1 / -1 !important;
        grid-row: 2 !important;
        width: 100% !important;
        height: 44px !important;
        padding: 10px !important;
        font-size: 16px !important;
        cursor: pointer;
        box-sizing: border-box !important;
    }

    /* Row 3: Results counter - full width, single line */
    #changelist-search>div>span {
        grid-column: 1 / -1 !important;
        grid-row: 3 !important;
        display: block !important;
        width: 100% !important;
        text-align: center !important;
        white-space: nowrap !important;
        overflow: hidden;
        text-overflow: ellipsis;
        padding: 4px 0 !important;
        margin: 0 !important;
    }

    /* Make the entire search form respect viewport bounds */
    #changelist-search {
        max-width: 100vw;
        box-sizing: border-box;
        overflow-x: hidden;
        padding: 0 10px;
    }

    /* Fix the toolbar overflow */
    #toolbar {
        max-width: 100vw;
        overflow-x: hidden;
    }

    /* Prevent horizontal scrolling on the changelist */
    #changelist {
        max-width: 100vw;
        overflow-x: auto;
    }
}
