/* You can add global styles to this file, and also import other style files */
@use 'sass:map';
@use '@angular/material' as mat;

@include mat.core();

// For Angular Material 21, Material 2 theme functions are available via the m2- prefix
// Try using the Material 2 compatibility API

// Define palettes - using Material 2 API with m2- prefix
// Custom indigo palette with white contrast for primary buttons
$indigo-palette: (
  50: #e8eaf6,
  100: #c5cae9,
  200: #9fa8da,
  300: #7986cb,
  400: #5c6bc0,
  500: #3f51b5,
  600: #3949ab,
  700: #303f9f,
  800: #283593,
  900: #1a237e,
  A100: #8c9eff,
  A200: #536dfe,
  A400: #3d5afe,
  A700: #304ffe,
  contrast: (
    50: rgba(black, 0.87),
    100: rgba(black, 0.87),
    200: rgba(black, 0.87),
    300: white,
    400: white,
    500: white,
    600: white,
    700: white,
    800: white,
    900: white,
    A100: rgba(black, 0.87),
    A200: white,
    A400: white,
    A700: white,
  ),
);

$yana-primary: mat.m2-define-palette($indigo-palette);
$yana-accent: mat.m2-define-palette(mat.$m2-pink-palette, A200, A100, A400);
$yana-warn: mat.m2-define-palette(mat.$m2-red-palette);

// Custom lighter blue palette for dark mode
$light-blue-50: #e3f2fd;
$light-blue-100: #bbdefb;
$light-blue-200: #2196f3;
$light-blue-300: #64b5f6;
$light-blue-400: #2196f3;
$light-blue-500: #2196f3;
$light-blue-600: #1e88e5;
$light-blue-700: #1976d2;
$light-blue-800: #1565c0;
$light-blue-900: #0d47a1;

$dark-mode-primary-palette: (
  50: $light-blue-50,
  100: $light-blue-100,
  200: $light-blue-200,
  300: $light-blue-300,
  400: $light-blue-400,
  500: $light-blue-500,
  600: $light-blue-600,
  700: $light-blue-700,
  800: $light-blue-800,
  900: $light-blue-900,
  A100: #82b1ff,
  A200: #448aff,
  A400: #2979ff,
  A700: #2962ff,
  contrast: (
    50: rgba(black, 0.87),
    100: rgba(black, 0.87),
    200: rgba(black, 0.87),
    300: rgba(black, 0.87),
    400: rgba(black, 0.87),
    500: white,
    600: white,
    700: white,
    800: white,
    900: white,
    A100: rgba(black, 0.87),
    A200: white,
    A400: white,
    A700: white,
  ),
);

$yana-dark-primary: mat.m2-define-palette($dark-mode-primary-palette, 200, 100, 300);

// Light theme
$yana-light-theme: mat.m2-define-light-theme(
  (
    color: (
      primary: $yana-primary,
      accent: $yana-accent,
      warn: $yana-warn,
    ),
    typography: mat.m2-define-typography-config(),
    density: 0,
  )
);

// Dark theme with lighter blue primary
$yana-dark-theme: mat.m2-define-dark-theme(
  (
    color: (
      primary: $yana-dark-primary,
      accent: $yana-accent,
      warn: $yana-warn,
    ),
    typography: mat.m2-define-typography-config(),
    density: 0,
  )
);

// Apply light theme by default
@include mat.all-component-themes($yana-light-theme);

// Apply dark theme when dark-theme class is on body
.dark-theme {
  @include mat.all-component-colors($yana-dark-theme);
}

// Global styles
html {
  height: 100%;
  margin: 0;
  padding: 0;
  overflow-x: hidden;
  font-family: Roboto, 'Helvetica Neue', sans-serif;
  width: 100%;
  max-width: 100vw;
  box-sizing: border-box;
  background-color: #fff;
}

body {
  min-height: 100%;
  margin: 0;
  padding: 0;
  overflow-y: auto;
  overflow-x: hidden;
  font-family: Roboto, 'Helvetica Neue', sans-serif;
  width: 100%;
  max-width: 100vw;
  box-sizing: border-box;
  background-color: #fff;
}

// Prevent horizontal overflow on all elements
* {
  box-sizing: border-box;
}

// Ensure app-root doesn't cause overflow
app-root {
  display: block;
  width: 100%;
  max-width: 100vw;
  overflow-x: hidden;
}

// Ensure Material sidenav-container allows sticky positioning
mat-sidenav-container {
  height: auto !important;
  min-height: 100vh;
  overflow: visible !important;
  position: relative !important;
}

mat-sidenav-content {
  height: auto !important;
  min-height: 100vh;
  overflow: visible !important;
  overflow-y: visible !important;
  overflow-x: visible !important;
  position: relative !important;
}

// Override Material's default drawer container styles
.mat-drawer-container {
  overflow: visible !important;
  position: relative !important;
}

.mat-sidenav-container {
  overflow: visible !important;
  position: relative !important;
}

// Dark mode contrast improvements for Material form fields
// Set dark background on html and body to prevent white line on mobile
html.dark-theme {
  background-color: #121212 !important;
}

html.dark-theme body {
  background-color: #121212 !important;
}

html.dark-theme app-root {
  background-color: #121212 !important;
}

.dark-theme {
  // Override Material CSS custom properties for better contrast
  // Override Material primary color variables with darker blue
  --mat-sys-primary: #2196f3 !important;
  --mat-sys-primary-container: rgba(33, 150, 243, 0.12) !important;
  --mat-sys-on-primary: #000000 !important;
  --mat-sys-on-primary-container: #2196f3 !important;
  --mat-sys-primary-rgb: 33, 150, 243 !important;

  // Override all Material primary color variants
  --mat-primary-50: #e3f2fd !important;
  --mat-primary-100: #bbdefb !important;
  --mat-primary-200: #2196f3 !important;
  --mat-primary-300: #2196f3 !important;
  --mat-primary-400: #2196f3 !important;
  --mat-primary-500: #2196f3 !important;
  --mat-primary-600: #1e88e5 !important;
  --mat-primary-700: #1976d2 !important;
  --mat-primary-800: #1565c0 !important;
  --mat-primary-900: #0d47a1 !important;

  // Override MDC theme primary color
  --mdc-theme-primary: #2196f3 !important;
  --mdc-theme-on-primary: #000000 !important;

  // Override Material form field colors
  --mdc-outlined-text-field-outline-color: rgba(33, 150, 243, 0.8) !important;
  --mdc-outlined-text-field-focus-outline-color: #2196f3 !important;
  --mdc-outlined-text-field-label-text-color: rgba(33, 150, 243, 0.9) !important;
  --mdc-outlined-text-field-focus-label-text-color: #2196f3 !important;

  // Override Material filled text field colors
  --mdc-filled-text-field-active-indicator-color: #2196f3 !important;
  --mdc-filled-text-field-focus-active-indicator-color: #2196f3 !important;
  --mdc-filled-text-field-label-text-color: rgba(33, 150, 243, 0.9) !important;
  --mdc-filled-text-field-focus-label-text-color: #2196f3 !important;

  // Override Material button colors
  --mdc-filled-button-container-color: #2196f3 !important;
  --mdc-filled-button-label-text-color: #000000 !important;
  --mdc-outlined-button-label-text-color: #2196f3 !important;
  --mdc-outlined-button-outline-color: #2196f3 !important;
  --mdc-text-button-label-text-color: #2196f3 !important;

  // Override Material chip colors
  --mdc-chip-container-color: rgba(33, 150, 243, 0.2) !important;
  --mdc-chip-label-text-color: #2196f3 !important;

  // Override Material progress bar colors
  --mdc-linear-progress-active-indicator-color: #2196f3 !important;
  --mdc-linear-progress-track-color: rgba(33, 150, 243, 0.2) !important;

  // Override Material switch colors
  --mdc-switch-selected-handle-color: #2196f3 !important;
  --mdc-switch-selected-track-color: rgba(33, 150, 243, 0.5) !important;

  // Override Material checkbox colors
  --mdc-checkbox-selected-checkmark-color: #000000 !important;
  --mdc-checkbox-selected-focus-icon-color: #2196f3 !important;
  --mdc-checkbox-selected-hover-icon-color: #2196f3 !important;
  --mdc-checkbox-selected-icon-color: #2196f3 !important;
  --mdc-checkbox-selected-pressed-icon-color: #2196f3 !important;

  // Override Material radio button colors
  --mdc-radio-selected-icon-color: #2196f3 !important;
  --mdc-radio-selected-focus-icon-color: #2196f3 !important;
  --mdc-radio-selected-hover-icon-color: #2196f3 !important;
  --mdc-radio-selected-pressed-icon-color: #2196f3 !important;

  // Material components use CSS variables defined above

  // Global text contrast improvements for dark mode
  body {
    color: rgba(255, 255, 255, 0.87) !important;
  }

  // Material card text contrast
  .mat-mdc-card {
    color: rgba(255, 255, 255, 0.87) !important;

    .mat-mdc-card-title {
      color: rgba(255, 255, 255, 0.95) !important;
    }

    .mat-mdc-card-subtitle {
      color: rgba(255, 255, 255, 0.8) !important;
    }
  }

  // Material typography improvements
  p,
  span,
  div,
  li,
  td,
  th {
    color: rgba(255, 255, 255, 0.87) !important;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    color: rgba(255, 255, 255, 0.95) !important;
  }

  // Links in dark mode - use CSS variables
  a {
    color: var(--mat-sys-primary) !important;

    &:hover {
      color: var(--mat-primary-200) !important;
    }
  }

  // Material button text
  .mat-mdc-button,
  .mat-mdc-raised-button,
  .mat-mdc-outlined-button {
    color: rgba(255, 255, 255, 0.87) !important;
  }

  // Material chip text
  .mat-mdc-chip {
    color: rgba(255, 255, 255, 0.87) !important;
  }

  // Material menu text
  .mat-mdc-menu-item {
    color: rgba(255, 255, 255, 0.87) !important;
  }

  // Loading and error text
  .loading p,
  .error p {
    color: rgba(255, 255, 255, 0.87) !important;
  }

  // Material tooltip background for dark mode
  .mat-mdc-tooltip {
    background-color: rgba(97, 97, 97, 0.9) !important;
    color: rgba(255, 255, 255, 0.87) !important;
    border-radius: 8px !important;
  }

  .mdc-tooltip__surface {
    background-color: rgba(97, 97, 97, 0.9) !important;
    color: rgba(255, 255, 255, 0.87) !important;
    border-radius: 8px !important;
  }

  // Material snackbar (notifications) background for dark mode
  .mat-mdc-snack-bar-container {
    background-color: rgba(66, 66, 66, 0.95) !important;
    color: rgba(255, 255, 255, 0.87) !important;
    border-radius: 12px !important;
  }

  .mdc-snackbar {
    .mdc-snackbar__surface {
      background-color: rgba(66, 66, 66, 0.95) !important;
      color: rgba(255, 255, 255, 0.87) !important;
      border-radius: 12px !important;
    }

    .mdc-snackbar__label {
      color: rgba(255, 255, 255, 0.87) !important;
    }

    .mat-mdc-snack-bar-action {
      color: var(--mat-sys-primary) !important;

      &:hover {
        color: var(--mat-primary-200) !important;
      }
    }
  }
}

// Light mode button text - white text for enabled buttons
// Global CSS variable override for light mode
:root:not(.dark-theme),
html:not(.dark-theme),
body:not(.dark-theme) {
  --mdc-filled-button-label-text-color: white !important;
  --mdc-outlined-button-label-text-color: white !important;
  --mdc-text-button-label-text-color: white !important;
  --mdc-filled-button-ink-color: white !important;
  --mdc-ripple-color: rgba(255, 255, 255, 0.1) !important;
}

// Target buttons when not in dark theme
html:not(.dark-theme),
body:not(.dark-theme) {
  // Filled/raised buttons with primary color - white text
  button.mat-mdc-raised-button[color="primary"]:not(:disabled),
  button.mat-mdc-unelevated-button[color="primary"]:not(:disabled),
  .mat-mdc-raised-button[color="primary"]:not(:disabled),
  .mat-mdc-unelevated-button[color="primary"]:not(:disabled),
  button[mat-raised-button][color="primary"]:not(:disabled) {
    --mdc-filled-button-label-text-color: white !important;
    
    .mdc-button__label,
    .mat-mdc-button-label {
      color: white !important;
    }
    
    span.mdc-button__label {
      color: white !important;
    }
  }
  
  // All enabled filled buttons (not just primary)
  button.mat-mdc-raised-button:not(:disabled):not([disabled]),
  button.mat-mdc-unelevated-button:not(:disabled):not([disabled]),
  .mat-mdc-raised-button:not(:disabled):not([disabled]),
  .mat-mdc-unelevated-button:not(:disabled):not([disabled]) {
    --mdc-filled-button-label-text-color: white !important;
    
    .mdc-button__label,
    .mat-mdc-button-label,
    span.mdc-button__label {
      color: white !important;
    }
  }
  
  // Outlined buttons - white text when enabled
  button.mat-mdc-outlined-button:not(:disabled):not([disabled]),
  .mat-mdc-outlined-button:not(:disabled):not([disabled]) {
    --mdc-outlined-button-label-text-color: white !important;
    
    .mdc-button__label,
    .mat-mdc-button-label,
    span.mdc-button__label {
      color: white !important;
    }
  }
  
  // Text buttons - white text when enabled
  button.mat-mdc-button:not(:disabled):not([disabled]),
  .mat-mdc-button:not(:disabled):not([disabled]) {
    --mdc-text-button-label-text-color: white !important;
    
    .mdc-button__label,
    .mat-mdc-button-label,
    span.mdc-button__label {
      color: white !important;
    }
  }
  
  // Universal selector for all Material button labels in light mode
  .mdc-button__label:not(:disabled),
  .mat-mdc-button-label:not(:disabled),
  .mdc-button__label span,
  .mat-mdc-button-label span {
    color: white !important;
  }
  
  // Target all enabled buttons more broadly - including nested content
  button:not(:disabled):not([disabled]) {
    .mdc-button__label,
    .mat-mdc-button-label,
    .mdc-button__label span,
    .mat-mdc-button-label span,
    span {
      color: white !important;
    }
  }
  
  // Target button action/content elements directly (similar to chip structure)
  .mdc-button:not(:disabled):not([disabled]),
  .mat-mdc-button:not(:disabled):not([disabled]) {
    .mdc-button__label,
    .mat-mdc-button-label {
      color: white !important;
    }
  }
  
  // Specifically target raised/unelevated buttons with any content
  button[mat-raised-button]:not(:disabled):not([disabled]),
  button.mat-mdc-raised-button:not(:disabled):not([disabled]),
  .mat-mdc-raised-button:not(:disabled):not([disabled]),
  button[mat-raised-button][color="primary"]:not(:disabled):not([disabled]) {
    color: white !important;
    
    .mdc-button__label,
    .mat-mdc-button-label,
    span:not(mat-icon),
    mat-icon {
      color: white !important;
    }
  }
  
  // Chip text - white ONLY for status-enabled chips in light mode (NOT gray chips, NOT regular primary chips)
  // Only target chips with status-enabled class, exclude all other primary chips and gray/disabled chips
  mat-chip.mat-mdc-chip.status-enabled:not([disabled]):not(.status-disabled),
  .mat-mdc-chip.status-enabled:not([disabled]):not(.status-disabled) {
    color: white !important;
    
    .mat-mdc-chip-action,
    .mdc-evolution-chip__action,
    .mdc-evolution-chip__cell,
    span {
      color: white !important;
    }
  }
  
  // Chip action elements - only for status-enabled chips (not gray, not regular primary)
  mat-chip.status-enabled:not(.status-disabled):not([disabled]) .mat-mdc-chip-action,
  mat-chip.status-enabled:not(.status-disabled):not([disabled]) .mdc-evolution-chip__action,
  mat-chip.status-enabled:not(.status-disabled):not([disabled]) .mdc-evolution-chip__cell {
    color: white !important;
  }
}

// Additional high-specificity overrides for primary buttons in light mode
:not(.dark-theme) button.mat-mdc-raised-button[color="primary"] .mdc-button__label,
:not(.dark-theme) button[mat-raised-button][color="primary"] .mdc-button__label,
:not(.dark-theme) .mat-mdc-raised-button[color="primary"] .mdc-button__label {
  color: white !important;
}

:not(.dark-theme) button.mat-mdc-raised-button[color="primary"],
:not(.dark-theme) button[mat-raised-button][color="primary"],
:not(.dark-theme) .mat-mdc-raised-button[color="primary"] {
  --mdc-filled-button-label-text-color: white !important;
}

// Material tooltip background for light mode
.mat-mdc-tooltip {
  background-color: rgba(97, 97, 97, 0.9) !important;
  color: rgba(255, 255, 255, 0.87) !important;
  border-radius: 8px !important;
}

.mdc-tooltip__surface {
  background-color: rgba(97, 97, 97, 0.9) !important;
  color: rgba(255, 255, 255, 0.87) !important;
  border-radius: 8px !important;
}

// Material snackbar (notifications) global styling
.mat-mdc-snack-bar-container {
  border-radius: 12px !important;
}

.mdc-snackbar .mdc-snackbar__surface {
  border-radius: 12px !important;
}

// Error snackbar styling
.mat-mdc-snack-bar-container.error-snackbar {
  background-color: #f44336 !important;
  color: #ffffff !important;
}

.mat-mdc-snack-bar-container.error-snackbar .mdc-snackbar__surface {
  background-color: #f44336 !important;
  color: #ffffff !important;
}

.mat-mdc-snack-bar-container.error-snackbar .mdc-snackbar__label {
  color: #ffffff !important;
}

.mat-mdc-snack-bar-container.error-snackbar .mat-mdc-button {
  color: #ffffff !important;
}

.dark-theme .mat-mdc-snack-bar-container.error-snackbar {
  background-color: #d32f2f !important;
  color: #ffffff !important;
}

.dark-theme .mat-mdc-snack-bar-container.error-snackbar .mdc-snackbar__surface {
  background-color: #d32f2f !important;
  color: #ffffff !important;
}

// ========================================
// GLOBAL UTILITIES & COMMON PATTERNS
// ========================================

// Animations
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

// Animation utility classes
.animate-fade-in {
  animation: fadeIn 0.3s ease-in;
}

.animate-slide-up {
  animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

// Transition timing
.transition-smooth {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.transition-fast {
  transition: all 0.2s ease;
}

// Container max-widths
.container-sm {
  max-width: 900px;
  margin: 0 auto;
}

.container-md {
  max-width: 1200px;
  margin: 0 auto;
}

.container-lg {
  max-width: 1400px;
  margin: 0 auto;
}

// State styles (loading, error, empty)
.state-center {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 80px 20px;
  text-align: center;
  min-height: 400px;
}

.state-center mat-icon {
  font-size: 64px;
  width: 64px;
  height: 64px;
  margin-bottom: 16px;
  opacity: 0.6;
}

.state-center p {
  font-size: 1.125rem;
  margin: 16px 0 24px 0;
}

.state-center.error p {
  color: var(--mat-sys-error);
}

// Icon size utilities
.icon-sm {
  font-size: 16px;
  width: 16px;
  height: 16px;
}

.icon-md {
  font-size: 48px;
  width: 48px;
  height: 48px;
}

.icon-lg {
  font-size: 64px;
  width: 64px;
  height: 64px;
}

// Card patterns
.card-elevated {
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
}

.card-elevated:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
}

// Card gradient bar (top accent)
.card-gradient-bar::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, var(--mat-sys-primary), var(--mat-sys-primary-container));
  opacity: 0;
  transition: opacity 0.3s ease;
}

.card-gradient-bar:hover::before {
  opacity: 1;
}

// Border radius utilities
.rounded-sm {
  border-radius: 8px;
}

.rounded-md {
  border-radius: 12px;
}

.rounded-lg {
  border-radius: 16px;
}

// Ensure images in article content fit within containers without overflow
.article-content img,
[class*='article-content'] img {
  max-width: 100% !important;
  width: 100% !important;
  height: auto !important;
  box-sizing: border-box !important;
  object-fit: contain !important;
}

// Make placeholders less prominent
.mat-mdc-form-field {
  input::placeholder,
  textarea::placeholder {
    opacity: 0.4 !important;
  }

  .mat-mdc-input-element::placeholder {
    opacity: 0.4 !important;
  }
}

// Dark mode placeholder styling
.dark-theme {
  .mat-mdc-form-field {
    input::placeholder,
    textarea::placeholder {
      opacity: 0.35 !important;
    }

    .mat-mdc-input-element::placeholder {
      opacity: 0.35 !important;
    }
  }
}
